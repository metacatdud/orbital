<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Orbital</title>
  <link rel="stylesheet" href="fontawesome/css/all.min.css" />
  <link rel="stylesheet" href="orbital.css" />
</head>

<body class="font-mono bg-theme text-theme min-h-screen transition-colors duration-200">
  <div id="loading-screen" class="loading-widget">
    <div class="p-6 max-w-sm">
      <div class="spinner"></div>
      <div class="loading-text">Loading ...</div>
    </div>
  </div>

  <div id="app-screen" class="app-widget"></div>

  <script type="module">
      import "./wasm_exec.js";

      const go = new Go();

      async function loadOrbital() {
        const wasmUrl = 'orbital.wasm'
        const wasmRes = await fetch(wasmUrl)

        if (!wasmRes.ok) {
          throw new Error(`[orbital] Failed to load ${wasmUrl}`);
        }

        const wasmResMime = wasmRes.headers.get('Content-Type') || ''

        let instance;

        if (WebAssembly.instantiateStreaming && wasmResMime.includes('wasm')) {
          const result = await WebAssembly.instantiateStreaming(wasmRes, go.importObject)
          instance = result.instance;
        } else {
          const buf = await wasmRes.arrayBuffer()
          const result = await WebAssembly.instantiate(new Uint8Array(buf), go.importObject)
          instance = result.instance;
        }

        await go.run(instance)
      }


      loadOrbital().catch(console.error)
  </script>
</body>
</html>